# n8n - Main Application
n8n.infiatin.cloud {
    reverse_proxy n8n:5678
    
    encode gzip
    
    # Headers untuk keamanan
    header {
        # Enable HSTS
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
        # Prevent clickjacking
        X-Frame-Options "SAMEORIGIN"
        # Prevent MIME type sniffing
        X-Content-Type-Options "nosniff"
        # XSS Protection
        X-XSS-Protection "1; mode=block"
    }
}

# WAHA - WhatsApp API (opsional: jika ingin expose dengan domain)
# waha.infiatin.cloud {
#     reverse_proxy waha:3000
#     encode gzip
# }

# Uptime Kuma - Monitoring (opsional: jika ingin expose dengan domain)
# status.infiatin.cloud {
#     reverse_proxy uptime-kuma:3001
#     encode gzip
# }

# Fallback untuk akses via port (local only)
:5679 {
    reverse_proxy n8n:5678
}

:3001 {
    reverse_proxy waha:3000
}

:3002 {
    reverse_proxy uptime-kuma:3001
}
